# チケットレス入場システム開発プロンプト・提案書

このドキュメントでは、Googleスプレッドシートを基盤としたチケットレス入場システムをAIに開発させるためのプロンプトと、システムの機能提案をまとめます。

## 1. システム構成案 (Architecture)

最も低コストかつ運用が容易な構成として、**Google Apps Script (GAS)** を利用したWebアプリケーションを提案します。

*   **データベース**: Google Spreadsheet (購入者リスト、入場記録)
*   **バックエンド**: Google Apps Script (メール送信、QR生成ロジック、API)
*   **フロントエンド**: GASで配信するHTML/JS Webアプリ (QR読み取り、入場管理画面)
*   **QRコード**: Google Chart API または JSライブラリで生成

## 2. 提案機能リスト (Feature List)

### 必須機能 (MVP)
1.  **QRコード一括生成・送信機能**:
    *   スプレッドシートの購入者リストからユニークなQRコード(トークン)を生成。
    *   購入者のメールアドレスにQRコード画像を添付(またはリンク)して一括送信。
2.  **入場管理Webアプリ (スタッフ用)**:
    *   スマホカメラでQRコードを読み取る機能。
    *   読み取ったQRコードをスプレッドシートと照合し、「未入場」なら「入場済み」に更新。
    *   「既に入場済み」の場合はエラーまたは警告を表示。
3.  **ステータス管理**:
    *   スプレッドシート上でリアルタイムに入場者数・未入場者数を可視化。

### 推奨追加機能
*   **同伴者対応**: 1つのQRコードで複数名入場可能にする、または人数分のQRを発行するロジック。
*   **オフライン対応 (簡易)**: 電波が悪い会場でも動作するように、直近のデータをローカルストレージにキャッシュする機能(高度)。
*   **手動チェックイン**: QRが読み取れない場合のために、名前やID検索でチェックインする機能。
*   **ダッシュボード**: 当日の来場推移をグラフ表示。

## 3. AIへの開発指示プロンプト (Recommended Prompts)

AIに開発を依頼する際は、役割を明確にし、ステップ・バイ・ステップで指示を出すと精度が高まります。以下は、一度に全体を依頼するのではなく、段階的に構築するためのプロンプト例です。

### ステップ1: 要件定義と基本設計
```markdown
あなたはGoogle Apps ScriptとWeb開発の専門家です。
以下の要件で「チケットレス入場システム」を開発したいです。まずは設計と必要なスプレッドシートの構造を提案してください。

【要件】
1. データソース: Googleスプレッドシートの「購入者リスト」シート (氏名, メール, 購入枚数, IDなど)。
2. 事前準備: スクリプトを実行すると、各購入者にユニークなQRコード用URLを発行し、メールで送付する。
3. 当日運用: スマホでアクセスできるWebアプリ(GAS)を用意し、カメラでQRを読み取ると、スプレッドシートの「CheckIn」列に日時が記録される。
4. 重複防止: 既に入場済みのQRコードが読み込まれた場合は警告を出す。

出力してほしいもの:
- スプレッドシートの推奨カラム構成
- システム全体の処理フロー図（テキストベースで可）
```

### ステップ2: QRコード生成とメール送信の実装
```markdown
設計ありがとうございます。では、ステップ1として「QRコード生成とメール送信」のGASコードを書いてください。

【詳細】
- シート名: "Attendees"
- カラム: A:ID, B:Name, C:Email, D:Token(QR用文字列), E:QRCodeURL, F:EmailSent(送信済フラグ)
- 機能:
  1. Tokenが空の行にユニークなID(UUIDなど)を生成して入力。
  2. Google Charts API等を使ってQRコード画像を生成(またはURL生成)。
  3. GmailAppを使って、QRコードを添付した招待メールを送信。
  4. 送信完了したらF列に「TRUE」と書き込む（二重送信防止）。
```

### ステップ3: 入場管理アプリ(QRリーダー)の実装
```markdown
次に、当日の受付スタッフが使う「QR読み取りWebアプリ」のコードを書いてください。

【詳細】
- GASの `doGet` でHTMLを表示。
- HTML5の `jsQR` ライブラリなどのCDNを利用して、スマホのカメラでQRコードをスキャンできるようにする。
- スキャン成功時、GAS側の関数 `google.script.run.checkInUser(token)` を呼び出す。
- サーバー側(GAS)では、受け取ったtokenをシートから検索し、
  - 未入場なら: "CheckInTime"列に現在時刻を記入し、成功メッセージを返す。
  - 入場済みなら: エラーメッセージと入場時間を返す。
  - 該当なしなら: 無効なチケットである旨を返す。
- フロントエンドは、その結果を画面に大きく表示する（OKなら緑、NGなら赤など）。
```

## 4. 開発のヒント (Tips)

*   **ライブラリの活用**: QR読み取りには `jsQR` や `html5-qrcode` などのライブラリをCDNで読み込むのが一般的です。
*   **権限設定**: GASをWebアプリとしてデプロイする際、「実行ユーザー: 自分」「アクセスできるユーザー: 全員（またはドメイン内）」の設定に注意が必要です。
*   **テスト**: 自分のスマホで実際に動作するか、PCのWebカメラだけでなく実機でテストすることが重要です。
